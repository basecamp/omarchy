#!/bin/bash
# X11 â†’ Wayland with hash-based deduplication
last_hash=""
while true; do
    # Wait for X11 clipboard change
    if clipnotify -s clipboard 2>/dev/null; then
        sleep 0.1
        # Get current X11 clipboard content
        current_content=$(xclip -selection clipboard -o 2>/dev/null || echo "")
        current_hash=$(echo -n "$current_content" | md5sum | cut -d' ' -f1)

        # Only sync if hash changed
        if [ "$current_hash" != "$last_hash" ] && [ -n "$current_content" ]; then
            # Write to Wayland
            echo -n "$current_content" | wl-copy --type text/plain 2>/dev/null
            last_hash="$current_hash"
        fi
    else
        sleep 1
    fi
done
