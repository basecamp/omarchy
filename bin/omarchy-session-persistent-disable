#!/bin/bash

# Disable persistent session mode for Omarchy
# Stops auto-save on shutdown and auto-restore on boot

PERSISTENT_FLAG="$HOME/.local/state/omarchy/session-persistent.enabled"
AUTOSTART_HOOK="$HOME/.config/hypr/autostart.conf"

rm -f "$PERSISTENT_FLAG"

# Disable systemd service
systemctl --user disable omarchy-session-save.service 2>/dev/null || true

# Remove autostart hook
if [[ -f "$AUTOSTART_HOOK" ]]; then
  sed -i '/omarchy-session-restore-if-persistent/d' "$AUTOSTART_HOOK"
  sed -i '/# Auto-restore session/d' "$AUTOSTART_HOOK"
fi

notify-send "Persistent Mode" "Auto-save & restore disabled" -i emblem-important

echo "Persistent mode: OFF"
