#!/bin/bash

set +e # Don't exit on error for omarchy-update-available check
omarchy-update-available
if [[ $? -eq 0 ]]; then
    if ! gum confirm "Proceed with update?"; then
        echo "Update cancelled."
        exit 1
    fi
fi
set -e # Re-enable exit on error

omarchy-snapshot create || [ $? -eq 127 ]
omarchy-update-git
omarchy-migrate
omarchy-update-system-pkgs
omarchy-update-restart
omarchy-restart-waybar # removes update-available icon
