#!/bin/bash

# Toggle the automated background cycling on or off.

STATE_FILE="$HOME/.local/state/omarchy/bg-cycle-active"
DAEMON_SCRIPT="omarchy-bg-cycle-daemon"

mkdir -p "$(dirname "$STATE_FILE")"

if [ -f "$STATE_FILE" ]; then
    rm "$STATE_FILE"
    # Kill the daemon if running
    pkill -f "$DAEMON_SCRIPT"
    notify-send "Background Cycling" "Disabled" -i preferences-desktop-wallpaper
else
    touch "$STATE_FILE"
    # Ensure daemon is running
    if ! pgrep -f "$DAEMON_SCRIPT" > /dev/null; then
        nohup "$DAEMON_SCRIPT" > /dev/null 2>&1 &
    fi
    notify-send "Background Cycling" "Enabled" -i preferences-desktop-wallpaper
fi
